<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿®æ­£åçš„å•ä½ç»Ÿè®¡é€»è¾‘æµ‹è¯•</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; 
            margin: 20px; 
            line-height: 1.6;
            background-color: #f5f5f5;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
            background: white; 
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { 
            color: #1890ff; 
            text-align: center; 
            margin-bottom: 30px;
        }
        .section { 
            margin-bottom: 30px; 
            padding: 20px; 
            border: 1px solid #e8e8e8; 
            border-radius: 6px;
            background: #fafafa;
        }
        .section h3 { 
            color: #333; 
            margin-top: 0; 
            border-bottom: 2px solid #1890ff;
            padding-bottom: 10px;
        }
        .correction-note {
            background: #fff7e6;
            border: 1px solid #ffd591;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #faad14;
        }
        .logic-flow {
            background: #e6f7ff;
            border: 1px solid #91d5ff;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
        }
        .logic-flow h4 {
            color: #1890ff;
            margin-top: 0;
        }
        .scenario {
            background: white;
            border: 1px solid #d9d9d9;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
        }
        .scenario h5 {
            color: #333;
            margin-top: 0;
            margin-bottom: 10px;
        }
        .example-data {
            background: #f6f6f6;
            border: 1px solid #d9d9d9;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
        }
        .expected-result {
            background: #f6ffed;
            border: 1px solid #b7eb8f;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
        }
        .expected-result h6 {
            color: #52c41a;
            margin: 0 0 5px 0;
        }
        ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        li {
            margin-bottom: 8px;
        }
        .highlight {
            background: #fff1b8;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>âœ… ä¿®æ­£åçš„å•ä½ç»Ÿè®¡é€»è¾‘æµ‹è¯•</h1>
        
        <div class="correction-note">
            <h4>ğŸ”§ ä¸šåŠ¡é€»è¾‘ä¿®æ­£</h4>
            <p><strong>é‡è¦ç†è§£</strong>ï¼šåœ¨å›½ç½‘ç»„ç»‡æ¶æ„ä¸­ï¼Œ<span class="highlight">çœä»½çº§å•ä½ï¼ˆå¦‚"å±±ä¸œ"ã€"æ±Ÿè‹"ï¼‰å°±æ˜¯äºŒçº§å•ä½</span>ï¼Œåªæœ‰åœ¨é€‰æ‹©äº†å…·ä½“å…¬å¸ç±»å‹æˆ–å…¬å¸ç±»å‹+æ‰¹æ¬¡æ—¶ï¼Œæ‰ä¼šå±•ç¤ºæ›´ç»†åˆ†çš„ä¸‹å±å•ä½ï¼ˆå¦‚ç§‘ç ”é™¢ã€äº§ä¸šé›†å›¢ç­‰ï¼‰ã€‚</p>
        </div>

        <div class="section">
            <h3>ğŸ“Š ä¿®æ­£åçš„æ•°æ®å¤„ç†é€»è¾‘</h3>
            
            <div class="logic-flow">
                <h4>ğŸ’¡ æ–°çš„å¤„ç†é€»è¾‘</h4>
                <ol>
                    <li><strong>é»˜è®¤æƒ…å†µ</strong>ï¼šçœä»½åç§°ï¼ˆå¦‚"å±±ä¸œ"ã€"æ±Ÿè‹"ï¼‰= äºŒçº§å•ä½ï¼Œæ­£å¸¸å±•ç¤º</li>
                    <li><strong>ç»†åˆ†æƒ…å†µ</strong>ï¼šå½“æœ‰æ›´ç»†åˆ†çš„å•ä½æ—¶ï¼ˆå¦‚"ç”µåŠ›ç§‘å­¦ç ”ç©¶é™¢"ã€"ç»æµæŠ€æœ¯ç ”ç©¶é™¢"ï¼‰ï¼Œå›¾è¡¨æ ‡é¢˜æ˜¾ç¤ºä¸º"ä¸‹å±å•ä½åˆ†å¸ƒ"</li>
                    <li><strong>ç»Ÿè®¡è®¡ç®—</strong>ï¼šè¦†ç›–äºŒçº§å•ä½æ•°é‡ = æœ‰å½•å–äººæ•°çš„æœ‰æ•ˆå•ä½æ•°é‡</li>
                    <li><strong>æ•°æ®å±•ç¤º</strong>ï¼šç›´æ¥ä½¿ç”¨unit_statistics.unitsä¸­çš„æ‰€æœ‰æœ‰æ•ˆæ•°æ®</li>
                </ol>
            </div>

            <div class="scenario">
                <h5>åœºæ™¯1ï¼šé»˜è®¤æŸ¥è¯¢ï¼ˆæ— å…·ä½“ç­›é€‰æ¡ä»¶ï¼‰</h5>
                <div class="example-data">
{
  "unit_statistics": {
    "covered_units": 52,
    "units": [
      {"unit_name": "å±±ä¸œ", "recruitment_count": 1283, "percentage": 6.46, "region": "åä¸œ"},
      {"unit_name": "æ–°ç–†", "recruitment_count": 1186, "percentage": 5.97, "region": "è¥¿åŒ—"},
      {"unit_name": "æ±Ÿè‹", "recruitment_count": 1159, "percentage": 5.84, "region": "åä¸œ"}
      // ... æ›´å¤šçœä»½
    ]
  }
}
                </div>
                <div class="expected-result">
                    <h6>é¢„æœŸå±•ç¤ºæ•ˆæœï¼š</h6>
                    <ul>
                        <li>å›¾è¡¨æ ‡é¢˜ï¼š<strong>"äºŒçº§å•ä½åˆ†å¸ƒ"</strong></li>
                        <li>è¦†ç›–å•ä½æ•°é‡ï¼š<strong>52</strong>ï¼ˆæ¥è‡ªcovered_unitså­—æ®µï¼‰</li>
                        <li>å›¾è¡¨å†…å®¹ï¼šå±•ç¤ºå±±ä¸œã€æ–°ç–†ã€æ±Ÿè‹ç­‰çœä»½çš„å½•å–åˆ†å¸ƒ</li>
                        <li>Tooltipï¼šæ˜¾ç¤ºå•ä½åç§°ã€åœ°åŒºã€å½•å–äººæ•°ã€å æ¯”</li>
                    </ul>
                </div>
            </div>

            <div class="scenario">
                <h5>åœºæ™¯2ï¼šé€‰æ‹©äº†å…¬å¸ç±»å‹+æ‰¹æ¬¡ï¼ˆæœ‰ç»†åˆ†å•ä½ï¼‰</h5>
                <div class="example-data">
{
  "unit_statistics": {
    "covered_units": 15,
    "units": [
      {"unit_name": "ç”µåŠ›ç§‘å­¦ç ”ç©¶é™¢", "recruitment_count": 164, "percentage": 0.83, "region": "æœªçŸ¥"},
      {"unit_name": "ç»æµæŠ€æœ¯ç ”ç©¶é™¢", "recruitment_count": 58, "percentage": 0.29, "region": "æœªçŸ¥"},
      {"unit_name": "ä¿¡é€šäº§ä¸šé›†å›¢", "recruitment_count": 231, "percentage": 1.16, "region": "æœªçŸ¥"},
      {"unit_name": "å®¢æœä¸­å¿ƒ", "recruitment_count": 15, "percentage": 0.08, "region": "æœªçŸ¥"}
      // ... æ›´å¤šç»†åˆ†å•ä½
    ]
  }
}
                </div>
                <div class="expected-result">
                    <h6>é¢„æœŸå±•ç¤ºæ•ˆæœï¼š</h6>
                    <ul>
                        <li>å›¾è¡¨æ ‡é¢˜ï¼š<strong>"ä¸‹å±å•ä½åˆ†å¸ƒ"</strong></li>
                        <li>è¦†ç›–å•ä½æ•°é‡ï¼š<strong>15</strong></li>
                        <li>å›¾è¡¨å†…å®¹ï¼šå±•ç¤ºç”µåŠ›ç§‘ç ”é™¢ã€ç»ç ”é™¢ã€äº§ä¸šé›†å›¢ç­‰ä¸‹å±å•ä½</li>
                        <li>Tooltipï¼šæ˜¾ç¤ºå•ä½å…¨åå’Œå½•å–æƒ…å†µ</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="section">
            <h3>ğŸ” å…³é”®ä¿®æ”¹ç‚¹</h3>
            
            <div class="scenario">
                <h5>1. secondaryUnitsCount è®¡ç®—é€»è¾‘</h5>
                <div class="example-data">
// ä¿®æ­£å‰ï¼šå¤æ‚çš„å•ä½ç±»å‹åˆ¤æ–­å’Œè¿‡æ»¤
// ä¿®æ­£åï¼šç›´æ¥ä½¿ç”¨covered_unitsæˆ–ç»Ÿè®¡æœ‰æ•ˆå•ä½æ•°é‡

const secondaryUnitsCount = computed(() => {
  // ä¼˜å…ˆä½¿ç”¨æ–°çš„unit_statistics.covered_unitså­—æ®µ
  if (props.data?.analytics?.unit_statistics?.covered_units !== undefined) {
    return props.data.analytics.unit_statistics.covered_units
  }
  
  // å¦‚æœæœ‰unit_statistics.unitsæ•°æ®ï¼Œç»Ÿè®¡æœ‰æ•ˆå•ä½æ•°é‡
  if (props.data?.analytics?.unit_statistics?.units) {
    const units = props.data.analytics.unit_statistics.units
    // è¿‡æ»¤æ‰å½•å–äººæ•°ä¸º0çš„å•ä½
    const validUnits = units.filter((unit: any) => (unit.recruitment_count || 0) > 0)
    return validUnits.length
  }
  
  // å…¼å®¹æ—§æ•°æ®ç»“æ„...
})
                </div>
            </div>

            <div class="scenario">
                <h5>2. regionChartTitle æ ‡é¢˜é€»è¾‘</h5>
                <div class="example-data">
// ä¿®æ­£åï¼šåŸºäºå•ä½ç±»å‹æ™ºèƒ½åˆ¤æ–­æ ‡é¢˜

const regionChartTitle = computed(() => {
  if (!props.data?.analytics?.unit_statistics?.units) return 'äºŒçº§å•ä½åˆ†å¸ƒ'
  
  const units = props.data.analytics.unit_statistics.units
  const provinceLevelKeywords = ['å±±ä¸œ', 'æ±Ÿè‹', 'æµ™æ±Ÿ', ...]
  
  // æ£€æŸ¥æ˜¯å¦æœ‰æ›´ç»†åˆ†çš„å•ä½ï¼ˆå¦‚å…·ä½“çš„åˆ†å…¬å¸ã€ç ”ç©¶é™¢ç­‰ï¼‰
  const hasSubUnits = units.some((unit: any) => {
    const unitName = unit.unit_name || ''
    if (provinceLevelKeywords.includes(unitName)) return false
    return unitName.includes('ç”µåŠ›ç§‘å­¦ç ”ç©¶é™¢') || 
           unitName.includes('ç»æµæŠ€æœ¯ç ”ç©¶é™¢') || 
           unitName.includes('åˆ†å…¬å¸') || unitName.includes('åˆ†éƒ¨') ||
           unitName.includes('äº§ä¸šé›†å›¢') || unitName.includes('å®¢æœä¸­å¿ƒ')
  })
  
  return hasSubUnits ? 'ä¸‹å±å•ä½åˆ†å¸ƒ' : 'äºŒçº§å•ä½åˆ†å¸ƒ'
})
                </div>
            </div>

            <div class="scenario">
                <h5>3. initRegionChart å›¾è¡¨æ•°æ®å¤„ç†</h5>
                <div class="example-data">
// ä¿®æ­£åï¼šä¸å†è¿‡æ»¤çœä»½æ•°æ®ï¼Œç›´æ¥ä½¿ç”¨æ‰€æœ‰æœ‰æ•ˆå•ä½

if (props.data.analytics?.unit_statistics?.units) {
  const units = props.data.analytics.unit_statistics.units
  
  // ç›´æ¥ä½¿ç”¨æ‰€æœ‰æœ‰æ•ˆçš„å•ä½æ•°æ®ï¼ˆåŒ…æ‹¬çœä»½ä½œä¸ºäºŒçº§å•ä½ï¼‰
  data = units
    .filter((unit: any) => (unit.recruitment_count || 0) > 0)
    .map((unit: any) => ({
      name: unit.unit_name || 'æœªçŸ¥',
      value: unit.recruitment_count || 0,
      region: unit.region || 'æœªçŸ¥',
      percentage: unit.percentage || 0
    }))
}

// æ’åºå¹¶å–å‰10å
data = data.sort((a, b) => b.value - a.value).slice(0, 10)
                </div>
            </div>
        </div>

        <div class="section">
            <h3>âœ… æµ‹è¯•éªŒè¯æ¸…å•</h3>
            
            <div class="logic-flow">
                <h4>åŠŸèƒ½éªŒè¯é¡¹ç›®</h4>
                <ul>
                    <li>âœ… <strong>çœä»½æ•°æ®æ­£ç¡®å±•ç¤º</strong>ï¼šå±±ä¸œã€æ±Ÿè‹ç­‰çœä»½ä½œä¸ºäºŒçº§å•ä½æ­£å¸¸æ˜¾ç¤º</li>
                    <li>âœ… <strong>ç»Ÿè®¡æ•°å­—å‡†ç¡®</strong>ï¼šè¦†ç›–äºŒçº§å•ä½æ•°é‡ä¸å®é™…æ•°æ®åŒ¹é…</li>
                    <li>âœ… <strong>å›¾è¡¨æ ‡é¢˜æ™ºèƒ½</strong>ï¼šæ ¹æ®æ•°æ®å†…å®¹æ˜¾ç¤º"äºŒçº§å•ä½åˆ†å¸ƒ"æˆ–"ä¸‹å±å•ä½åˆ†å¸ƒ"</li>
                    <li>âœ… <strong>Tooltipä¿¡æ¯å®Œæ•´</strong>ï¼šæ˜¾ç¤ºå•ä½åç§°ã€åœ°åŒºã€å½•å–äººæ•°ã€å æ¯”</li>
                    <li>âœ… <strong>æ•°æ®æ’åºæ­£ç¡®</strong>ï¼šæŒ‰å½•å–äººæ•°é™åºæ’åˆ—ï¼Œå–å‰10å</li>
                    <li>âœ… <strong>ç‚¹å‡»äº‹ä»¶æ­£å¸¸</strong>ï¼šç‚¹å‡»å›¾è¡¨é¡¹è§¦å‘æ­£ç¡®çš„é’»å–äº‹ä»¶</li>
                </ul>
            </div>

            <div class="expected-result">
                <h6>ğŸ¯ é¢„æœŸæ”¹è¿›æ•ˆæœ</h6>
                <ol>
                    <li><strong>ä¸šåŠ¡é€»è¾‘æ­£ç¡®</strong>ï¼šçœä»½ä½œä¸ºäºŒçº§å•ä½å¾—åˆ°æ­£ç¡®è¯†åˆ«å’Œå±•ç¤º</li>
                    <li><strong>ç”¨æˆ·ä½“éªŒæå‡</strong>ï¼šå›¾è¡¨æ ‡é¢˜å’Œå†…å®¹ä¸å®é™…æ•°æ®åŒ¹é…</li>
                    <li><strong>æ•°æ®å±•ç¤ºå‡†ç¡®</strong>ï¼šç»Ÿè®¡æ•°å­—ä¸å®é™…æƒ…å†µä¸€è‡´</li>
                    <li><strong>åŠŸèƒ½æ‰©å±•æ€§å¥½</strong>ï¼šæ”¯æŒä¸åŒæŸ¥è¯¢æ¡ä»¶ä¸‹çš„æ•°æ®å±•ç¤º</li>
                </ol>
            </div>
        </div>

        <div class="section">
            <h3>ğŸš€ æµ‹è¯•å»ºè®®</h3>
            
            <div class="scenario">
                <h5>æµ‹è¯•æ­¥éª¤</h5>
                <ol>
                    <li><strong>é»˜è®¤æŸ¥è¯¢æµ‹è¯•</strong>ï¼šä¸é€‰æ‹©ä»»ä½•ç­›é€‰æ¡ä»¶ï¼ŒéªŒè¯äºŒçº§å•ä½åˆ†å¸ƒå›¾è¡¨æ˜¾ç¤ºçœä»½æ•°æ®</li>
                    <li><strong>å…¬å¸ç±»å‹ç­›é€‰æµ‹è¯•</strong>ï¼šé€‰æ‹©å…·ä½“çš„å…¬å¸ç±»å‹ï¼Œè§‚å¯Ÿæ˜¯å¦æ˜¾ç¤ºæ›´ç»†åˆ†çš„ä¸‹å±å•ä½</li>
                    <li><strong>æ‰¹æ¬¡ç­›é€‰æµ‹è¯•</strong>ï¼šé€‰æ‹©å…¬å¸ç±»å‹+æ‰¹æ¬¡ï¼ŒéªŒè¯ä¸‹å±å•ä½åˆ†å¸ƒçš„å±•ç¤º</li>
                    <li><strong>ç»Ÿè®¡æ•°å­—éªŒè¯</strong>ï¼šæ£€æŸ¥"è¦†ç›–äºŒçº§å•ä½"æ•°é‡æ˜¯å¦ä¸å®é™…æ•°æ®åŒ¹é…</li>
                    <li><strong>äº¤äº’åŠŸèƒ½æµ‹è¯•</strong>ï¼šç‚¹å‡»å›¾è¡¨ä¸­çš„å•ä½ï¼ŒéªŒè¯é’»å–åŠŸèƒ½æ˜¯å¦æ­£å¸¸</li>
                </ol>
            </div>

            <div class="expected-result">
                <h6>ğŸ“Š å…³é”®éªŒè¯ç‚¹</h6>
                <ul>
                    <li>ç¡®è®¤"å±±ä¸œ"ã€"æ±Ÿè‹"ç­‰çœä»½åœ¨å›¾è¡¨ä¸­æ­£å¸¸æ˜¾ç¤º</li>
                    <li>ç¡®è®¤å›¾è¡¨æ ‡é¢˜æ ¹æ®æ•°æ®ç±»å‹æ­£ç¡®æ˜¾ç¤º</li>
                    <li>ç¡®è®¤è¦†ç›–å•ä½ç»Ÿè®¡æ•°å­—å‡†ç¡®ï¼ˆåº”ä¸º52ï¼‰</li>
                    <li>ç¡®è®¤Tooltipæ˜¾ç¤ºå®Œæ•´ä¿¡æ¯ï¼ˆå«åœ°åŒºå’Œå æ¯”ï¼‰</li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>