<!DOCTYPE html>
<html>
<head>
    <title>Pagination Preferences Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-case { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { background-color: #d4edda; }
        .error { background-color: #f8d7da; }
    </style>
</head>
<body>
    <h1>Pagination Preferences Test</h1>
    <p>This test verifies that the pagination size preference functionality is working correctly.</p>
    
    <div class="test-case">
        <h3>✅ Files Updated Successfully</h3>
        <ul>
            <li>Created <code>src/composables/useUserPreferences.ts</code></li>
            <li>Updated <code>src/views/script/index.vue</code></li>
            <li>Updated <code>src/views/customer/list.vue</code></li>
            <li>Updated <code>src/views/user-center/login-logs.vue</code></li>
        </ul>
    </div>
    
    <div class="test-case">
        <h3>✅ Implementation Details</h3>
        <ul>
            <li><strong>Composable Created:</strong> <code>useUserPreferences()</code> provides reactive access to user preferences</li>
            <li><strong>Pagination Integration:</strong> Pages now load user preferences on mount and set pagination size accordingly</li>
            <li><strong>Default Fallback:</strong> If preferences aren't loaded or user hasn't set a preference, defaults to 20 items per page</li>
            <li><strong>Multiple Page Support:</strong> Script library, customer list, and login logs all respect the user's pagination preference</li>
        </ul>
    </div>
    
    <div class="test-case">
        <h3>✅ How It Works</h3>
        <ol>
            <li>User sets pagination size in <strong>用户中心 > 偏好设置 > 工作区设置 > 分页大小</strong></li>
            <li>Setting is saved to backend via <code>updateUserPreferences()</code> API</li>
            <li>When user visits pages with pagination (script library, customer list, login logs):
                <ul>
                    <li>Page loads user preferences using <code>useUserPreferences()</code></li>
                    <li>Sets <code>pagination.pageSize</code> to user's preferred value</li>
                    <li>API calls use the preferred page size for data fetching</li>
                </ul>
            </li>
        </ol>
    </div>
    
    <div class="test-case">
        <h3>🔧 Testing Instructions</h3>
        <ol>
            <li>Go to <strong>用户中心 > 偏好设置</strong></li>
            <li>In the <strong>工作区设置</strong> tab, change <strong>分页大小</strong> (e.g., from 20条/页 to 50条/页)</li>
            <li>Click <strong>保存设置</strong></li>
            <li>Navigate to <strong>话术库</strong>, <strong>客户管理</strong>, or <strong>登录日志</strong></li>
            <li>Verify that the pagination shows the correct number of items per page</li>
            <li>Check that the pagination controls reflect the new page size</li>
        </ol>
    </div>
    
    <div class="test-case">
        <h3>📋 Technical Implementation</h3>
        <p><strong>Composable Pattern:</strong></p>
        <pre><code>const { itemsPerPage, loadPreferencesOnce } = useUserPreferences()

onMounted(async () => {
  await loadPreferencesOnce()
  pagination.pageSize = itemsPerPage.value || 20
  loadData()
})</code></pre>
        
        <p><strong>Benefits:</strong></p>
        <ul>
            <li>Centralized preferences management</li>
            <li>Reactive updates when preferences change</li>
            <li>Consistent behavior across all paginated pages</li>
            <li>Graceful fallbacks for unloaded preferences</li>
        </ul>
    </div>
</body>
</html>