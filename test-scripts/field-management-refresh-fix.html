<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å­—æ®µç®¡ç†è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½ä¿®å¤æŠ¥å‘Š</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
      line-height: 1.6;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h1 {
      color: #52c41a;
      border-bottom: 2px solid #52c41a;
      padding-bottom: 10px;
      margin-bottom: 30px;
    }
    h2 {
      color: #333;
      margin-top: 30px;
      margin-bottom: 15px;
      border-left: 4px solid #1890ff;
      padding-left: 10px;
    }
    .problem {
      background: #fff2e8;
      border: 1px solid #ffbb96;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }
    .solution {
      background: #f6ffed;
      border: 1px solid #95de64;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }
    .code-block {
      background: #f6f8fa;
      border: 1px solid #d0d7de;
      border-radius: 6px;
      padding: 15px;
      margin: 10px 0;
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
      font-size: 14px;
      overflow-x: auto;
    }
    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    .comparison-table th,
    .comparison-table td {
      border: 1px solid #d9d9d9;
      padding: 12px;
      text-align: left;
    }
    .comparison-table th {
      background: #fafafa;
      font-weight: 600;
    }
    .step {
      display: flex;
      align-items: flex-start;
      margin: 15px 0;
    }
    .step-number {
      background: #1890ff;
      color: white;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      margin-right: 15px;
      font-weight: bold;
      flex-shrink: 0;
    }
    .step-content {
      flex: 1;
    }
    .test-scenario {
      background: #e6f7ff;
      border: 1px solid #91d5ff;
      border-radius: 6px;
      padding: 15px;
      margin: 10px 0;
    }
    .warning {
      background: #fff2e8;
      border: 1px solid #ffbb96;
      border-radius: 6px;
      padding: 15px;
      margin: 15px 0;
      color: #d4380d;
    }
    .before-after {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }
    .before {
      background: #fff1f0;
      border: 1px solid #ffa39e;
      border-radius: 6px;
      padding: 15px;
    }
    .after {
      background: #f6ffed;
      border: 1px solid #b7eb8f;
      border-radius: 6px;
      padding: 15px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ”„ å­—æ®µç®¡ç†è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½ä¿®å¤æŠ¥å‘Š</h1>
    
    <div class="problem">
      <h3>ğŸš¨ é—®é¢˜æè¿°</h3>
      <p><strong>ç”¨æˆ·åé¦ˆï¼š</strong>"æå‰æ‰¹æ¿å—å’Œå†œç½‘æ¿å—åœ¨æ–°å¢æˆ–è€…ä¿®æ”¹å­—æ®µä¹‹åä¸ä¼šè‡ªåŠ¨åˆ·æ–°æ¿å—"</p>
      <p><strong>å½±å“ï¼š</strong>ç”¨æˆ·åœ¨å­—æ®µç®¡ç†ä¸­æ·»åŠ ã€ç¼–è¾‘æˆ–åˆ é™¤å­—æ®µåï¼Œéœ€è¦æ‰‹åŠ¨åˆ·æ–°é¡µé¢æ‰èƒ½çœ‹åˆ°å˜åŒ–ï¼Œç”¨æˆ·ä½“éªŒä¸ä½³ã€‚</p>
    </div>

    <h2>ğŸ” é—®é¢˜åˆ†æ</h2>

    <div class="code-block">
<strong>ç°æœ‰æœºåˆ¶æ£€æŸ¥ï¼š</strong>

âœ… æå‰æ‰¹æ¿å—æœ‰ handleFieldsUpdated() å‡½æ•°
âœ… å†œç½‘æ¿å—æœ‰ handleFieldsUpdated() å‡½æ•°  
âœ… ä¸¤ä¸ªæ¿å—éƒ½ç›‘å¬ @fields-updated äº‹ä»¶
âœ… FieldManagerDialog ç»„ä»¶ç¡®å®å‘å‡º fields-updated äº‹ä»¶

<strong>é—®é¢˜æ ¹æºï¼š</strong>
âŒ åªæœ‰åœ¨"ä¿å­˜æ›´æ”¹"(å­—æ®µæ’åº)æ—¶æ‰å‘å‡º fields-updated äº‹ä»¶
âŒ å­—æ®µæ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤æ“ä½œåæ²¡æœ‰å‘å‡ºäº‹ä»¶
    </div>

    <h2>ğŸ“Š äº‹ä»¶è§¦å‘æ£€æŸ¥ç»“æœ</h2>

    <table class="comparison-table">
      <thead>
        <tr>
          <th>æ“ä½œç±»å‹</th>
          <th>å‡½æ•°å</th>
          <th>ä¿®å¤å‰</th>
          <th>ä¿®å¤å</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>ğŸ”„ å­—æ®µæ’åº</td>
          <td><code>handleSave()</code></td>
          <td style="color: #52c41a;">âœ… å‘å‡º fields-updated</td>
          <td style="color: #52c41a;">âœ… å‘å‡º fields-updated</td>
        </tr>
        <tr>
          <td>â• æ–°å¢å­—æ®µ</td>
          <td><code>handleFieldAdded()</code></td>
          <td style="color: #cf1322;">âŒ æœªå‘å‡ºäº‹ä»¶</td>
          <td style="color: #52c41a;">âœ… å‘å‡º fields-updated</td>
        </tr>
        <tr>
          <td>âœï¸ ç¼–è¾‘å­—æ®µ</td>
          <td><code>handleFieldEdited()</code></td>
          <td style="color: #cf1322;">âŒ æœªå‘å‡ºäº‹ä»¶</td>
          <td style="color: #52c41a;">âœ… å‘å‡º fields-updated</td>
        </tr>
        <tr>
          <td>ğŸ—‘ï¸ åˆ é™¤å­—æ®µ</td>
          <td><code>deleteField()</code></td>
          <td style="color: #cf1322;">âŒ æœªå‘å‡ºäº‹ä»¶</td>
          <td style="color: #52c41a;">âœ… å‘å‡º fields-updated</td>
        </tr>
      </tbody>
    </table>

    <h2>ğŸ› ï¸ ä¿®å¤æ–¹æ¡ˆ</h2>

    <div class="solution">
      <h4>è§£å†³æ€è·¯ï¼š</h4>
      <p>åœ¨æ‰€æœ‰ä¼šå½±å“å­—æ®µçŠ¶æ€çš„æ“ä½œå®Œæˆåï¼Œéƒ½è§¦å‘ <code>fields-updated</code> äº‹ä»¶ï¼Œé€šçŸ¥çˆ¶ç»„ä»¶ï¼ˆæå‰æ‰¹/å†œç½‘æ¿å—ï¼‰åˆ·æ–°æ•°æ®ã€‚</p>
    </div>

    <div class="before-after">
      <div class="before">
        <h4>âŒ ä¿®å¤å‰</h4>
        <div class="code-block">
const handleFieldAdded = () => {
  loadFields() // åªé‡æ–°åŠ è½½å­—æ®µåˆ—è¡¨
}

const handleFieldEdited = async (...) => {
  await loadFields()
  // ç¼ºå°‘äº‹ä»¶é€šçŸ¥
}

const deleteField = async (...) => {
  // åˆ é™¤æ“ä½œ
  // ç¼ºå°‘äº‹ä»¶é€šçŸ¥
}
        </div>
      </div>
      
      <div class="after">
        <h4>âœ… ä¿®å¤å</h4>
        <div class="code-block">
const handleFieldAdded = () => {
  loadFields() // é‡æ–°åŠ è½½å­—æ®µåˆ—è¡¨
  emit('fields-updated') // âœ… é€šçŸ¥åˆ·æ–°
}

const handleFieldEdited = async (...) => {
  await loadFields()
  emit('fields-updated') // âœ… é€šçŸ¥åˆ·æ–°
}

const deleteField = async (...) => {
  // åˆ é™¤æ“ä½œ
  emit('fields-updated') // âœ… é€šçŸ¥åˆ·æ–°
}
        </div>
      </div>
    </div>

    <h2>ğŸ“ å…·ä½“ä¿®å¤å†…å®¹</h2>

    <div class="step">
      <div class="step-number">1</div>
      <div class="step-content">
        <strong>ä¿®å¤å­—æ®µæ·»åŠ äº‹ä»¶</strong>
        <div class="code-block">
// æ–‡ä»¶ï¼šFieldManagerDialog.vue
// ä½ç½®ï¼šhandleFieldAdded å‡½æ•°

+ emit('fields-updated') // é€šçŸ¥çˆ¶ç»„ä»¶åˆ·æ–°æ•°æ®
        </div>
      </div>
    </div>

    <div class="step">
      <div class="step-number">2</div>
      <div class="step-content">
        <strong>ä¿®å¤å­—æ®µç¼–è¾‘äº‹ä»¶</strong>
        <div class="code-block">
// æ–‡ä»¶ï¼šFieldManagerDialog.vue  
// ä½ç½®ï¼šhandleFieldEdited å‡½æ•°

+ emit('fields-updated') // é€šçŸ¥çˆ¶ç»„ä»¶åˆ·æ–°æ•°æ®
        </div>
      </div>
    </div>

    <div class="step">
      <div class="step-number">3</div>
      <div class="step-content">
        <strong>ä¿®å¤å­—æ®µåˆ é™¤äº‹ä»¶</strong>
        <div class="code-block">
// æ–‡ä»¶ï¼šFieldManagerDialog.vue
// ä½ç½®ï¼šdeleteField å‡½æ•°

+ emit('fields-updated') // é€šçŸ¥çˆ¶ç»„ä»¶åˆ·æ–°æ•°æ®
        </div>
      </div>
    </div>

    <h2>ğŸ§ª æµ‹è¯•åœºæ™¯</h2>

    <div class="test-scenario">
      <h4>æµ‹è¯•åœºæ™¯1ï¼šæ–°å¢å­—æ®µ</h4>
      <div class="step">
        <div class="step-number">1</div>
        <div class="step-content">æ‰“å¼€æå‰æ‰¹æ¿å—çš„å­—æ®µç®¡ç†</div>
      </div>
      <div class="step">
        <div class="step-number">2</div>
        <div class="step-content">ç‚¹å‡»"æ·»åŠ å­—æ®µ"ï¼Œåˆ›å»ºæ–°çš„è‡ªå®šä¹‰å­—æ®µ</div>
      </div>
      <div class="step">
        <div class="step-number">3</div>
        <div class="step-content">ä¿å­˜å­—æ®µ</div>
      </div>
      <div class="step">
        <div class="step-number">4</div>
        <div class="step-content"><strong>é¢„æœŸï¼š</strong>æå‰æ‰¹æ¿å—è‡ªåŠ¨åˆ·æ–°ï¼Œæ–°å­—æ®µç«‹å³æ˜¾ç¤º</div>
      </div>
    </div>

    <div class="test-scenario">
      <h4>æµ‹è¯•åœºæ™¯2ï¼šç¼–è¾‘å­—æ®µ</h4>
      <div class="step">
        <div class="step-number">1</div>
        <div class="step-content">åœ¨å­—æ®µç®¡ç†ä¸­ç‚¹å‡»ç¼–è¾‘æŸä¸ªå­—æ®µ</div>
      </div>
      <div class="step">
        <div class="step-number">2</div>
        <div class="step-content">ä¿®æ”¹å­—æ®µåç§°æˆ–æ˜¾ç¤ºé¡ºåº</div>
      </div>
      <div class="step">
        <div class="step-number">3</div>
        <div class="step-content">ä¿å­˜ä¿®æ”¹</div>
      </div>
      <div class="step">
        <div class="step-number">4</div>
        <div class="step-content"><strong>é¢„æœŸï¼š</strong>æ¿å—è‡ªåŠ¨åˆ·æ–°ï¼Œå­—æ®µæ˜¾ç¤ºæ›´æ–°çš„å†…å®¹</div>
      </div>
    </div>

    <div class="test-scenario">
      <h4>æµ‹è¯•åœºæ™¯3ï¼šåˆ é™¤å­—æ®µ</h4>
      <div class="step">
        <div class="step-number">1</div>
        <div class="step-content">åœ¨å­—æ®µç®¡ç†ä¸­ç‚¹å‡»åˆ é™¤æŸä¸ªå­—æ®µ</div>
      </div>
      <div class="step">
        <div class="step-number">2</div>
        <div class="step-content">ç¡®è®¤åˆ é™¤</div>
      </div>
      <div class="step">
        <div class="step-number">3</div>
        <div class="step-content"><strong>é¢„æœŸï¼š</strong>æ¿å—è‡ªåŠ¨åˆ·æ–°ï¼Œåˆ é™¤çš„å­—æ®µä»é¡µé¢æ¶ˆå¤±</div>
      </div>
    </div>

    <div class="test-scenario">
      <h4>æµ‹è¯•åœºæ™¯4ï¼šå†œç½‘æ¿å—éªŒè¯</h4>
      <div class="step">
        <div class="step-number">1</div>
        <div class="step-content">åœ¨å†œç½‘æ¿å—é‡å¤ä¸Šè¿°æ‰€æœ‰æ“ä½œ</div>
      </div>
      <div class="step">
        <div class="step-number">2</div>
        <div class="step-content"><strong>é¢„æœŸï¼š</strong>å†œç½‘æ¿å—çš„å­—æ®µç®¡ç†ä¹Ÿèƒ½è‡ªåŠ¨åˆ·æ–°</div>
      </div>
    </div>

    <h2>ğŸ¯ ä¿®å¤æ•ˆæœ</h2>

    <div class="solution">
      <h4>âœ… ç°åœ¨ç”¨æˆ·å¯ä»¥äº«å—å®Œæ•´çš„è‡ªåŠ¨åˆ·æ–°ä½“éªŒï¼š</h4>
      <ul>
        <li><strong>ğŸ”„ æ’åºå­—æ®µï¼š</strong>è°ƒæ•´å­—æ®µé¡ºåºåæ¿å—ç«‹å³åˆ·æ–°</li>
        <li><strong>â• æ–°å¢å­—æ®µï¼š</strong>æ·»åŠ å­—æ®µåæ¿å—ç«‹å³æ˜¾ç¤ºæ–°å­—æ®µ</li>
        <li><strong>âœï¸ ç¼–è¾‘å­—æ®µï¼š</strong>ä¿®æ”¹å­—æ®µä¿¡æ¯åæ¿å—ç«‹å³æ›´æ–°æ˜¾ç¤º</li>
        <li><strong>ğŸ—‘ï¸ åˆ é™¤å­—æ®µï¼š</strong>åˆ é™¤å­—æ®µåæ¿å—ç«‹å³ç§»é™¤è¯¥å­—æ®µ</li>
        <li><strong>ğŸ¨ ä¸€è‡´æ€§ï¼š</strong>æå‰æ‰¹å’Œå†œç½‘æ¿å—è¡Œä¸ºå®Œå…¨ä¸€è‡´</li>
        <li><strong>ğŸ“± ç”¨æˆ·ä½“éªŒï¼š</strong>æ— éœ€æ‰‹åŠ¨åˆ·æ–°ï¼Œæ“ä½œå“åº”æ›´æµç•…</li>
      </ul>
    </div>

    <div class="warning">
      <h4>âš ï¸ æ³¨æ„äº‹é¡¹</h4>
      <ul>
        <li>å­—æ®µç®¡ç†æ“ä½œå¯èƒ½ä¼šè§¦å‘å¤šæ¬¡ API è°ƒç”¨ï¼Œç¡®ä¿ç½‘ç»œè¿æ¥ç¨³å®š</li>
        <li>å¤§é‡å­—æ®µçš„æ¿å—åˆ·æ–°å¯èƒ½éœ€è¦å‡ ç§’é’Ÿæ—¶é—´</li>
        <li>å¦‚æœåˆ·æ–°å¤±è´¥ï¼Œç”¨æˆ·ä»å¯æ‰‹åŠ¨åˆ·æ–°é¡µé¢</li>
      </ul>
    </div>

    <h2>ğŸš€ æŠ€æœ¯è¦ç‚¹æ€»ç»“</h2>

    <div class="code-block">
<strong>äº‹ä»¶é©±åŠ¨çš„ UI æ›´æ–°æ¨¡å¼ï¼š</strong>

1. å­ç»„ä»¶(FieldManagerDialog)æ‰§è¡Œæ“ä½œ
2. æ“ä½œå®Œæˆåå‘å‡ºäº‹ä»¶ emit('fields-updated')
3. çˆ¶ç»„ä»¶(æå‰æ‰¹/å†œç½‘)ç›‘å¬äº‹ä»¶ @fields-updated="handleFieldsUpdated"
4. çˆ¶ç»„ä»¶é‡æ–°åŠ è½½æ•°æ® loadEarlyBatchData() / loadRuralGridData()
5. UI è‡ªåŠ¨æ›´æ–°æ˜¾ç¤ºæœ€æ–°çŠ¶æ€

<strong>å…³é”®åŸåˆ™ï¼š</strong>
- æ¯ä¸ªå½±å“æ•°æ®çŠ¶æ€çš„æ“ä½œéƒ½åº”è¯¥é€šçŸ¥çˆ¶ç»„ä»¶
- äº‹ä»¶åç§°è¦ä¿æŒä¸€è‡´
- çˆ¶ç»„ä»¶çš„å¤„ç†å‡½æ•°è¦èƒ½æ­£ç¡®åˆ·æ–°æ‰€æœ‰ç›¸å…³æ•°æ®
    </div>

    <p style="text-align: center; margin-top: 40px; color: #52c41a; font-size: 18px; font-weight: bold;">
      ğŸ‰ ä¿®å¤å®Œæˆï¼ç”¨æˆ·ç°åœ¨å¯ä»¥äº«å—å®Œå…¨è‡ªåŠ¨åŒ–çš„å­—æ®µç®¡ç†ä½“éªŒï¼
    </p>

    <p style="text-align: center; margin-top: 20px; color: #666; font-size: 14px;">
      ğŸ“ ç”Ÿæˆæ—¶é—´: <script>document.write(new Date().toLocaleString('zh-CN'))</script>
    </p>
  </div>
</body>
</html>