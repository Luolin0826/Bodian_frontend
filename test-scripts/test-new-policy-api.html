<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•æ–°ç»Ÿä¸€æ”¿ç­–API</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .test-section { margin-bottom: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 4px; }
        .success { background: #f6ffed; border: 1px solid #b7eb8f; color: #389e0d; }
        .error { background: #fff2f0; border: 1px solid #ffccc7; color: #cf1322; }
        .info { background: #f0f9ff; border: 1px solid #91d5ff; color: #1890ff; }
        button { padding: 8px 16px; margin-right: 10px; margin-bottom: 10px; border: none; border-radius: 4px; cursor: pointer; background: #1890ff; color: white; }
        button:hover { background: #40a9ff; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <div class="container">
        <h1>æ–°ç»Ÿä¸€æ”¿ç­–æ¿å—APIæµ‹è¯•</h1>
        
        <div class="test-section">
            <h2>ğŸ”— APIå¥åº·æ£€æŸ¥</h2>
            <button onclick="testHealthCheck()">æµ‹è¯•å¥åº·æ£€æŸ¥</button>
            <div id="health-result"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ“‹ åŸºæœ¬æ”¿ç­–ä¿¡æ¯</h2>
            <button onclick="testGetBasicPolicy()">è·å–åŸºæœ¬æ”¿ç­–</button>
            <button onclick="testUpdateBasicPolicy()">æ›´æ–°åŸºæœ¬æ”¿ç­–</button>
            <div id="basic-result"></div>
        </div>

        <div class="test-section">
            <h2>â° æå‰æ‰¹æ”¿ç­–ä¿¡æ¯</h2>
            <button onclick="testGetEarlyBatch()">è·å–æå‰æ‰¹æ”¿ç­–</button>
            <button onclick="testUpdateEarlyBatch()">æ›´æ–°æå‰æ‰¹æ”¿ç­–</button>
            <div id="early-batch-result"></div>
        </div>

        <div class="test-section">
            <h2>âš¡ å†œç½‘æ”¿ç­–ä¿¡æ¯</h2>
            <button onclick="testGetRuralGrid()">è·å–å†œç½‘æ”¿ç­–</button>
            <button onclick="testUpdateRuralGrid()">æ›´æ–°å†œç½‘æ”¿ç­–</button>
            <div id="rural-grid-result"></div>
        </div>

        <div class="test-section">
            <h2>ğŸŒ æ‰€æœ‰æ¿å—ä¿¡æ¯</h2>
            <button onclick="testGetAllSections()">è·å–æ‰€æœ‰æ¿å—</button>
            <div id="all-sections-result"></div>
        </div>
    </div>

    <script>
        const BASE_URL = 'http://localhost:8088';
        const TEST_UNIT_ID = 44; // æµ‹è¯•ç”¨çš„å•ä½ID

        function showResult(containerId, type, message, data = null) {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = `<strong>${type.toUpperCase()}:</strong> ${message}`;
            if (data) {
                div.innerHTML += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            }
            container.appendChild(div);
        }

        async function testHealthCheck() {
            const container = document.getElementById('health-result');
            container.innerHTML = '';
            
            try {
                const response = await fetch(`${BASE_URL}/api/v1/policy-sections/health`);
                const data = await response.json();
                
                if (response.ok) {
                    showResult('health-result', 'success', 'å¥åº·æ£€æŸ¥é€šè¿‡', data);
                } else {
                    showResult('health-result', 'error', 'å¥åº·æ£€æŸ¥å¤±è´¥', data);
                }
            } catch (error) {
                showResult('health-result', 'error', `è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        async function testGetBasicPolicy() {
            const container = document.getElementById('basic-result');
            container.innerHTML = '';
            
            try {
                const response = await fetch(`${BASE_URL}/api/v1/policy-sections/${TEST_UNIT_ID}/basic`);
                const data = await response.json();
                
                if (response.ok) {
                    showResult('basic-result', 'success', 'åŸºæœ¬æ”¿ç­–è·å–æˆåŠŸ', data);
                } else {
                    showResult('basic-result', 'error', 'åŸºæœ¬æ”¿ç­–è·å–å¤±è´¥', data);
                }
            } catch (error) {
                showResult('basic-result', 'error', `è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        async function testUpdateBasicPolicy() {
            const container = document.getElementById('basic-result');
            
            const testData = {
                recruitment_count: 'æµ‹è¯•æ›´æ–°_' + Date.now(),
                admission_ratio: '5:1',
                comprehensive_score_line: '75åˆ†'
            };
            
            try {
                const response = await fetch(`${BASE_URL}/api/v1/policy-sections/${TEST_UNIT_ID}/basic`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(testData)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showResult('basic-result', 'success', 'åŸºæœ¬æ”¿ç­–æ›´æ–°æˆåŠŸ', data);
                } else {
                    showResult('basic-result', 'error', 'åŸºæœ¬æ”¿ç­–æ›´æ–°å¤±è´¥', data);
                }
            } catch (error) {
                showResult('basic-result', 'error', `è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        async function testGetEarlyBatch() {
            const container = document.getElementById('early-batch-result');
            container.innerHTML = '';
            
            try {
                const response = await fetch(`${BASE_URL}/api/v1/policy-sections/${TEST_UNIT_ID}/early-batch`);
                const data = await response.json();
                
                if (response.ok) {
                    showResult('early-batch-result', 'success', 'æå‰æ‰¹æ”¿ç­–è·å–æˆåŠŸ', data);
                } else {
                    showResult('early-batch-result', 'error', 'æå‰æ‰¹æ”¿ç­–è·å–å¤±è´¥', data);
                }
            } catch (error) {
                showResult('early-batch-result', 'error', `è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        async function testUpdateEarlyBatch() {
            const container = document.getElementById('early-batch-result');
            
            const testData = {
                schedule_arrangement: 'æµ‹è¯•æå‰æ‰¹å®‰æ’_' + Date.now(),
                interview_process: 'ä¸‰è½®é¢è¯•',
                selection_criteria: 'ç»¼åˆè¯„ä¼°'
            };
            
            try {
                const response = await fetch(`${BASE_URL}/api/v1/policy-sections/${TEST_UNIT_ID}/early-batch`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(testData)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showResult('early-batch-result', 'success', 'æå‰æ‰¹æ”¿ç­–æ›´æ–°æˆåŠŸ', data);
                } else {
                    showResult('early-batch-result', 'error', 'æå‰æ‰¹æ”¿ç­–æ›´æ–°å¤±è´¥', data);
                }
            } catch (error) {
                showResult('early-batch-result', 'error', `è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        async function testGetRuralGrid() {
            const container = document.getElementById('rural-grid-result');
            container.innerHTML = '';
            
            try {
                const response = await fetch(`${BASE_URL}/api/v1/policy-sections/${TEST_UNIT_ID}/rural-grid`);
                const data = await response.json();
                
                if (response.ok) {
                    showResult('rural-grid-result', 'success', 'å†œç½‘æ”¿ç­–è·å–æˆåŠŸ', data);
                } else {
                    showResult('rural-grid-result', 'error', 'å†œç½‘æ”¿ç­–è·å–å¤±è´¥', data);
                }
            } catch (error) {
                showResult('rural-grid-result', 'error', `è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        async function testUpdateRuralGrid() {
            const container = document.getElementById('rural-grid-result');
            
            const testData = {
                work_environment: 'æµ‹è¯•å†œç½‘ç¯å¢ƒ_' + Date.now(),
                salary_structure: 'åŸºæœ¬å·¥èµ„+ç»©æ•ˆ',
                career_development: 'æŠ€æœ¯+ç®¡ç†åŒé€šé“'
            };
            
            try {
                const response = await fetch(`${BASE_URL}/api/v1/policy-sections/${TEST_UNIT_ID}/rural-grid`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(testData)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showResult('rural-grid-result', 'success', 'å†œç½‘æ”¿ç­–æ›´æ–°æˆåŠŸ', data);
                } else {
                    showResult('rural-grid-result', 'error', 'å†œç½‘æ”¿ç­–æ›´æ–°å¤±è´¥', data);
                }
            } catch (error) {
                showResult('rural-grid-result', 'error', `è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        async function testGetAllSections() {
            const container = document.getElementById('all-sections-result');
            container.innerHTML = '';
            
            try {
                const response = await fetch(`${BASE_URL}/api/v1/policy-sections/${TEST_UNIT_ID}/all`);
                const data = await response.json();
                
                if (response.ok) {
                    showResult('all-sections-result', 'success', 'æ‰€æœ‰æ¿å—ä¿¡æ¯è·å–æˆåŠŸ', data);
                } else {
                    showResult('all-sections-result', 'error', 'æ‰€æœ‰æ¿å—ä¿¡æ¯è·å–å¤±è´¥', data);
                }
            } catch (error) {
                showResult('all-sections-result', 'error', `è¯·æ±‚å¤±è´¥: ${error.message}`);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ‰§è¡Œå¥åº·æ£€æŸ¥
        window.onload = function() {
            showResult('health-result', 'info', 'å‡†å¤‡è¿›è¡ŒAPIæµ‹è¯•...');
            setTimeout(testHealthCheck, 1000);
        };
    </script>
</body>
</html>